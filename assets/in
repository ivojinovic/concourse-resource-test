#!/bin/bash
# vim: set ft=sh

set -e

exec 3>&1 # make stdout available as fd 3 for the result
exec 1>&2 # redirect all output to stderr for logging

#REF="cba8422359aa242694978f581cf3f0c754ec5542"
#jq -n "{version: {ref: $REF},metadata: {}}" >&3

#git clone --branch master ssh://git@github.com/ivojinovic/concourse-resource-test.git $1
#git checkout 7257964759d838170815b8d89dbb47a1382c6ac1

cd $1
echo "TEST" > test.txt

read inputs
echo $inputs > inputs.txt

jq -n '{
  "version": { "ref": "7257964759d838170815b8d89dbb47a1382c6ac1" },
  "metadata": [
    { "name": "commit", "value": "7257964759d838170815b8d89dbb47a1382c6ac1" },
    { "name": "author", "value": "Ivan Vojinovic" }
  ]
}' >&3